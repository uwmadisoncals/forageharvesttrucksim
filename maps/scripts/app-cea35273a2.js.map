{"version":3,"sources":["scripts/app-cea35273a2.js"],"names":["angular","module","config","$logProvider","toastrConfig","debugEnabled","allowHtml","timeOut","positionClass","preventDuplicates","progressBar","directive","NavbarController","moment","vm","this","relativeDate","creationDate","fromNow","$inject","restrict","templateUrl","scope","controller","controllerAs","bindToController","$stateProvider","$urlRouterProvider","otherwise","state","url","factory","ACTIONS","colors","LOADING","WAIT","FIELD_EMPTY","FIELD_LOADED","ROAD_EMPTY","ROAD_LOADED","UNLOAD","READY","constant","HOLD","$injector","HarvestSimulator","harvester","trucks","field","self","copy","tonsHarvested","map","truck","machines","concat","forEach","machine","actionLog","prototype","summarize","totalWaitSecs","summaries","thisMachine","tonnes","loadingSec","waitingSec","loads","action","duration","totalTime","utilization","effectiveThroughput","push","result","shift","truckWaitSecs","run","time","start","rate","capacity","isUndefined","setState","newState","extra","extend","fieldTravelDone","travel","hasArrived","haul","road","finishedUnloading","unload","smallerTruckWaiting","i","length","otherTruck","isDefined","shouldSendPartial","current_load","minPartial","index","sendPartials","holdTrucks","summary","fromJson","name","rawData","get","data","actions","label","$templateCache","$templateRequest","terminal","compile","element","attr","type","src","id","prefix","root","then","response","put","$scope","$timeout","update","simulator","chopper","chartMeta","chart","refresh","$watchCollection","$watch","$http","$compile","$interpolate","fields","observe","localStorage","getItem","tooltip","e","mergeLeft","thisIndex","indexOf","removed","splice","hideTooltip","mergeRight","remove","series","toRemove","dragFn","startAction","endAction","startIndex","endIndex","item","presetOrders","7","34","289","setItem","values","order","sort","a","b","workingTime","unloadSec","idleSec","isHarvester","unloadPer","$q","d3","ngModelOptions","debounce","default","blur","truck_types","apron","dump","semi","tractor","presetTruck","preset","presetSimulations","selectPreset","removeTruck","addTruck","truckCount","getCurrentAction","log","formatter","value","style","rangeChoices","valuesName","callback","$new","margin","left","meta","actionKey","color","require","link","attrs","ngModelCtrl","fromUser","text","trim","toUser","object","toJson","$parsers","$formatters","ngModel","newValue","oldValue","$setViewValue","$render","filter","seconds","residual","minutes","toString","slice","Date","setSeconds","decimal","fractionSize","toFixed","options","formatTime","format","formatMinutes","d","dataGroups","drawAxes","scales","xAxis","svg","axis","scale","x","orient","tickFormat","yAxis","y","dims","dimensions","canvas","height","width","append","top","bottom","call","row","fullRowHeight","gutter","dragStartAction","drawValue","xmin","domain","rect","barHeight","on","tipScope","html","contents","transition","event","pageY","pageX","undefined","drawData","getScales","yDomain","yRange","innerHeight","ordinal","range","reverse","utc","parseInt","right","el","resize","offsetHeight","offsetWidth","innerWidth","select","selectAll","$log","clipboard","Clipboard","trigger","copyData","debug","$rootScope","intToTime","hourFormat","noData","showLegend","showControls","contentGenerator","point","clipEdge","stacked","axisLabel","showMaxMin","axisLabelDistance","ticks","opts","w","h","malarkey"],"mappings":"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","file":"scripts/app-cea35273a2.js","sourcesContent":["(function() {\n  'use strict';\nangular.module('trucksim', ['ui.bootstrap', 'ui.router', 'toastr'])\n  .config(function($logProvider, toastrConfig) {\n    // Enable log\n    $logProvider.debugEnabled(true);\n\n    // Set options third-party lib\n    toastrConfig.allowHtml = true;\n    toastrConfig.timeOut = 3000;\n    toastrConfig.positionClass = 'toast-top-right';\n    toastrConfig.preventDuplicates = true;\n    toastrConfig.progressBar = true;\n  })\n  .directive( function acmeNavbar() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/navbar/navbar.html',\n      scope: {\n          creationDate: '='\n      },\n      controller: NavbarController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function NavbarController(moment) {\n      var vm = this;\n\n      // \"vm.creationDate\" is available by directive option \"bindToController: true\"\n      vm.relativeDate = moment(vm.creationDate).fromNow();\n    }\n  })\n  .config(function($stateProvider, $urlRouterProvider) {\n    $urlRouterProvider.otherwise(\"/home\");\n\n    $stateProvider\n      .state('home', {\n        url: '/home',\n        templateUrl: 'template/home.html'\n      })\n      .state('/observed', {\n        url: '/observed',\n        templateUrl: 'template/observed.html'\n      });\n  })\n  .factory('colors', function (ACTIONS) {\n    var colors = {};\n    colors[ACTIONS.LOADING] = '#1FC01F';\n    colors[ACTIONS.WAIT] = '#C01F1F';\n    colors[ACTIONS.FIELD_EMPTY] = '#728C72';\n    colors[ACTIONS.FIELD_LOADED] = colors[ACTIONS.FIELD_EMPTY];\n    colors[ACTIONS.ROAD_EMPTY] = '#D9822A';\n    colors[ACTIONS.ROAD_LOADED] = colors[ACTIONS.ROAD_EMPTY];\n    colors[ACTIONS.UNLOAD] = '#2A2AD9';\n    colors[ACTIONS.READY] = '#FFFFFF';\n\n    return colors;\n  });\n})();\n\nangular.module('trucksim')\n  .constant('ACTIONS', {\n    LOADING: 'loading',\n    WAIT: 'wait',\n    FIELD_EMPTY: 'field_travel1',\n    ROAD_EMPTY: 'road1',\n    FIELD_LOADED: 'field_travel2',\n    ROAD_LOADED: 'road2',\n    UNLOAD: 'unload',\n    READY: 'ready', // pre-harvest\n    HOLD: 'onHold'\n  })\n  .factory('HarvestSimulator', function(ACTIONS, $injector){\n\n    function HarvestSimulator(harvester, trucks, field){\n      var self = this;\n      self.field = angular.copy(field);\n      self.tonsHarvested = 0;\n      self.harvester = angular.copy(harvester);\n      self.trucks = trucks.map(function (truck) { return angular.copy(truck); });\n      self.machines = [self.harvester].concat(self.trucks);\n      self.machines.forEach(function (machine) {\n        machine.actionLog = [];\n      });\n    }\n\n    HarvestSimulator.prototype.summarize = function () {\n      var self = this,\n        totalWaitSecs = 0,\n        summaries = [];\n\n      self.machines.forEach(function (machine) {\n        var thisMachine = {\n          tonnes: 0,\n          loadingSec: 0,\n          waitingSec: 0,\n          loads: 0\n        };\n        machine.actionLog.forEach(function (state) {\n          if ( state.action === ACTIONS.LOADING){\n            thisMachine.tonnes += state.tonnes;\n            thisMachine.loads++;\n            thisMachine.loadingSec += state.duration;\n          }\n          else if ( state.action === ACTIONS.WAIT ){\n            thisMachine.waitingSec += state.duration;\n            totalWaitSecs += state.duration;\n          }\n        });\n        thisMachine.totalTime = thisMachine.loadingSec + thisMachine.waitingSec;\n        thisMachine.utilization = thisMachine.loadingSec / thisMachine.totalTime;\n        thisMachine.effectiveThroughput = thisMachine.tonnes / thisMachine.totalTime *  3600;\n        summaries.push(thisMachine);\n      });\n\n      var result = {\n        harvester: summaries.shift(),\n        trucks: summaries\n      };\n      result.truckWaitSecs = totalWaitSecs - result.harvester.waitingSec;\n      return result;\n    };\n\n    HarvestSimulator.prototype.run = function() {\n      var self = this;\n      var time = 0;\n      var harvester = self.harvester;\n      harvester.state = {\n        action: ACTIONS.WAIT,\n        start: 0\n      };\n      harvester.rate = self.harvester.capacity / 3600.0;\n\n      self.trucks.forEach(function (truck) {\n        if (angular.isUndefined(truck.state)) {\n          truck.state = {\n            action: ACTIONS.READY,\n            start: 0\n          };\n        }\n      });\n\n      var setState = function (machine, newState, extra) {\n        machine.state.duration = time - machine.state.start;\n        angular.extend(machine.state, extra);\n        if ( machine.state.duration > 0 ){\n          machine.actionLog.push(machine.state);\n        }\n        machine.state = {\n          action: newState,\n          start: time\n        };\n      };\n\n      var fieldTravelDone = function (machine) {\n        return time - machine.state.start > (self.field.travel/machine.field * 3600);\n      };\n\n      var hasArrived = function (machine) {\n        return time - machine.state.start > (self.field.haul/machine.road * 3600);\n      };\n\n      var finishedUnloading = function (machine) {\n        return time - machine.state.start > machine.unload;\n      };\n\n      var smallerTruckWaiting = function(truck){\n        for ( var i=self.trucks.length; i--;){\n          var otherTruck = self.trucks[i];\n          if ( angular.isDefined(otherTruck) && otherTruck.capacity < truck.capacity && otherTruck.state.action === ACTIONS.WAIT ){\n            return true;\n          }\n        }\n      };\n\n      var shouldSendPartial = function (truck) {\n        if ( truck.current_load < truck.capacity * self.field.minPartial ){\n          return false;\n        }\n        return smallerTruckWaiting(truck);\n      };\n\n      while (self.tonsHarvested < self.field.tonnes) {\n        self.trucks.forEach(function (truck, index) {\n          if (truck.state.action === ACTIONS.FIELD_EMPTY && fieldTravelDone(truck)) {\n            setState(truck, ACTIONS.WAIT);\n          }\n\n          if ((truck.state.action === ACTIONS.WAIT || truck.state.action === ACTIONS.READY) && harvester.state.action === ACTIONS.WAIT) {\n            // start loading this truck\n            setState(truck, ACTIONS.LOADING);\n            setState(harvester, ACTIONS.LOADING);\n            truck.current_load = 0;\n          }\n          if (truck.state.action === ACTIONS.HOLD && harvester.state.action === ACTIONS.WAIT){\n            setState(harvester, ACTIONS.LOADING);\n            truck.state.action = ACTIONS.LOADING;\n          }\n\n          if (truck.state.action === ACTIONS.LOADING) {\n            truck.current_load += harvester.rate;\n            self.tonsHarvested += harvester.rate;\n\n            if (truck.current_load > truck.capacity || (self.field.sendPartials && shouldSendPartial(truck) ) ) {\n              setState(truck, ACTIONS.FIELD_LOADED, {tonnes: truck.current_load});\n              setState(harvester, ACTIONS.WAIT, {tonnes: truck.current_load});\n            }\n            if (self.field.holdTrucks && smallerTruckWaiting(truck) ){\n              setState(harvester, ACTIONS.WAIT, {tonnes: truck.current_load});\n              truck.state.action = ACTIONS.HOLD;\n            }\n          }\n\n          if (truck.state.action === ACTIONS.FIELD_LOADED && fieldTravelDone(truck)) {\n            setState(truck, ACTIONS.ROAD_LOADED);\n          }\n\n          if (truck.state.action === ACTIONS.ROAD_LOADED && hasArrived(truck)) {\n            setState(truck, ACTIONS.UNLOAD);\n          }\n\n          if (truck.state.action === ACTIONS.UNLOAD && finishedUnloading(truck)) {\n            setState(truck, ACTIONS.ROAD_EMPTY);\n          }\n\n          if (truck.state.action === ACTIONS.ROAD_EMPTY && hasArrived(truck)) {\n            setState(truck, ACTIONS.FIELD_EMPTY);\n          }\n\n          if (truck.state.action === ACTIONS.FIELD_EMPTY && fieldTravelDone(truck)) {\n            setState(truck, ACTIONS.WAIT);\n          }\n\n        });\n\n        time++;\n      }\n      self.trucks.forEach(function (truck) {\n        if (truck.state.action === ACTIONS.LOADING) {\n          setState(truck, ACTIONS.FIELD_LOADED, {tonnes: truck.current_load});\n          setState(harvester, ACTIONS.WAIT, {tonnes: truck.current_load});\n        }\n      });\n\n      self.summary = self.summarize();\n\n      return self.machines;\n    };\n\n    HarvestSimulator.prototype.fromJson = function (name) {\n      // requires data to be in a predefined constant\n      var rawData = angular.fromJson($injector.get(name));\n      var data = {};\n      angular.forEach(rawData, function (actions, machine) {\n        data.label = machine;\n        data.actionLog = actions;\n      });\n\n    };\n\n    return HarvestSimulator;\n  });\n\nangular.module('trucksim')\n.directive('script', function($templateCache, $templateRequest) {\n    return {\n      restrict: 'E',\n      terminal: true,\n      compile: function(element, attr) {\n        if (attr.type === 'text/ng-template' && attr.src && !attr.id) {\n          var prefix = attr.root ||'';\n          $templateRequest(prefix + attr.src).then(function (response) {\n            $templateCache.put(attr.src, response);\n          });\n        }\n      }\n    };\n  });\n\nangular\n  .module('trucksim')\n  .controller('simulationCtrl', function ($scope, $timeout, HarvestSimulator) {\n    var update = function () {\n      var simulator = new HarvestSimulator($scope.chopper, $scope.trucks, $scope.field);\n      $scope.chartMeta.data = simulator.run();\n      $scope.summary = simulator.summary;\n      $timeout(function () {\n        $scope.chart.refresh();\n      });\n    };\n    update();\n    $scope.update = update;\n\n\n    $scope.$watchCollection('chopper', update);\n    $scope.$watch('trucks', update, true);\n    $scope.$watchCollection('field', update);\n  });\n\n\nangular\n  .module('trucksim')\n.controller('observationCtrl', function ($scope, $http, $timeout, $compile, $interpolate, $templateCache, ACTIONS) {\n  $scope.fields = [ 7, 34, 289 ];\n  $scope.observe = {\n    field: localStorage.getItem('observeField') || $scope.fields[0]\n  };\n\n  $scope.chartMeta.tooltip = function(e, scope){\n    // var scope = $scope.$new();\n    // scope.data = e;\n    // scope.point = e;\n\n\n    /**\n     * Combine this action with the following action\n     */\n    scope.mergeLeft = function(){\n      var thisIndex = scope.actionLog.indexOf(scope.data) - 1;\n      var removed = scope.actionLog.splice(thisIndex, 1)[0];\n      scope.data.duration += removed.duration;\n      scope.data.start -= removed.duration;\n      scope.hideTooltip();\n      $timeout(function(){$scope.chart.refresh();});\n    };\n\n    /**\n     * Combine this action with the preceeding action\n     */\n    scope.mergeRight = function () {\n      var thisIndex = scope.actionLog.indexOf(scope.data) + 1;\n      var removed = scope.actionLog.splice(thisIndex, 1)[0];\n      scope.data.duration += removed.duration;\n      scope.hideTooltip();\n      $timeout(function(){$scope.chart.refresh();});\n    };\n\n    /**\n     * Remove the action and shift everything afterward\n     */\n    scope.remove = function () {\n      scope.actionLog.splice(scope.actionLog.indexOf(scope.data), 1);\n      $scope.chartMeta.data.forEach(function (series) {\n        var toRemove = [];\n        series.actionLog.forEach(function (action) {\n\n          if ( action.start >= scope.data.start + scope.data.duration ){\n            // action starts after removed action ends - move only\n            action.start -= scope.data.duration;\n          }\n          else if ( action.start >= scope.data.start ){\n            // action starts after removed action\n            if ( action.start + action.duration >= scope.data.start + scope.data.duration ){\n              // action ends after removed action - move and shorten\n              action.duration -= scope.data.start + scope.data.duration - action.start\n              action.start -= scope.data.duration;\n\n            }\n            else {\n              // action ends during removed action, remove it\n              // mark it for removal, because we don't want to alter array during iteration\n              toRemove.push(action);\n            }\n          }\n          else if ( action.start + action.duration > scope.data.start ){\n            // action begins before removed action, but ends during it\n            action.duration = scope.data.start - action.start;\n          }\n        });\n\n        // toRemove.forEach(function (action) {\n        //   series.actionLog.splice(series.actionLog.indexOf(action), 1);\n        // });\n      });\n      $timeout(function(){$scope.chart.refresh();});\n    };\n\n    return $templateCache.get('template/editTooltip.html');\n  };\n\n  $scope.chartMeta.dragFn = function (startAction, endAction) {\n    var actionLog = this,\n      startIndex = actionLog.indexOf(startAction),\n      endIndex = actionLog.indexOf(endAction),\n      duration, removed;\n    if ( startIndex < 0 || endIndex < 0 || startIndex === endIndex ){ return; }\n\n    if (startIndex > endIndex ){\n      removed = actionLog.splice(endIndex, startIndex - endIndex);\n      removed.forEach(function (item) {\n        startAction.duration += item.duration;\n        startAction.start -= item.duration;\n      });\n    }\n    else {\n      removed = actionLog.splice(startIndex + 1, endIndex - startIndex);\n      removed.forEach(function (item) {\n        startAction.duration += item.duration;\n      });\n    }\n\n    $timeout(function(){$scope.chart.refresh();});\n  };\n\n  var presetOrders = {\n    7: [\"4\", \"2\", \"5\"],\n    34: [\"12\", \"9\", \"7\", \"8\"],\n    289: [\"145\", \"144\", \"146\"]\n  };\n\n  var update = function () {\n    localStorage.setItem('observeField', $scope.observe.field);\n    $http.get('/json/field_' + $scope.observe.field + '.json')\n      .then(function (response) {\n        var rawData = response.data;\n        var data = [{\n          machine: 'harvester',\n          label: 'Harvester',\n          actionLog: rawData.harvester\n        }];\n        angular.forEach(rawData, function (values, machine) {\n          if ( machine === 'harvester'){ return; }\n          data.push({\n            machine: machine,\n            label: 'Truck ' + machine,\n            actionLog: values\n          });\n        });\n\n        var order = presetOrders[$scope.observe.field] || []\n        data.sort(function(a, b){\n          if ( a.machine === 'harvester' ){\n            return - 1;\n          }\n          return order.indexOf(a.machine) - order.indexOf(b.machine);\n        });\n        $scope.chartMeta.data = data;\n        $timeout(function () {\n          $scope.chart.refresh();\n        });\n\n        // Generate Summary\n        $scope.summary = {\n          tonnes: 0,\n          workingTime: 0,\n          trucks: []\n        };\n        data.forEach(function (machine) {\n          var thisMachine = {\n            tonnes: 0,\n            loadingSec: 0,\n            waitingSec: 0,\n            unloadSec: 0,\n            idleSec: 0,\n            loads: 0,\n            label: machine.label\n          };\n          machine.actionLog.forEach(function (state) {\n            thisMachine.isHarvester = machine.machine === 'harvester';\n            if ( state.action === ACTIONS.LOADING){\n              if ( !thisMachine.isHarvester && state.tonnes > 0){\n                thisMachine.tonnes += state.tonnes;\n                $scope.summary.tonnes += state.tonnes;\n                $scope.summary.workingTime += state.duration;\n                thisMachine.loads++;\n              }\n              thisMachine.loadingSec += state.duration;\n            }\n            else if ( state.action === ACTIONS.WAIT ){\n              thisMachine.waitingSec += state.duration;\n            }\n            else if ( state.action === ACTIONS.UNLOAD || state.action === 'scale' || state.action === 'taxi' ){\n              thisMachine.unloadSec += state.duration;\n            }\n            else if ( thisMachine.isHarvester ){\n              thisMachine.idleSec += state.duration;\n            }\n          });\n\n          if ( thisMachine.isHarvester ){\n            $scope.summary.harvester = thisMachine;\n          }\n          else{\n            thisMachine.unloadPer = thisMachine.unloadSec / thisMachine.loads;\n            $scope.summary.trucks.push(thisMachine);\n          }\n        });\n\n        var thisMachine = $scope.summary.harvester;\n        thisMachine.totalTime = thisMachine.loadingSec + thisMachine.waitingSec + thisMachine.idleSec;\n        thisMachine.utilization = thisMachine.loadingSec / thisMachine.totalTime;\n        thisMachine.tonnes = $scope.summary.tonnes;\n        thisMachine.effectiveThroughput = thisMachine.tonnes / thisMachine.totalTime *  3600;\n        thisMachine.capacity = thisMachine.tonnes / $scope.summary.workingTime *  3600;\n      });\n  };\n  update();\n  $scope.update = update;\n\n\n  $scope.$watch('observe.field', update);\n\n});\n\n(function() {\n'use strict';\nangular\n  .module('trucksim')\n  .controller('mainCtrl', function($scope, $timeout, $interpolate, $templateCache, $q, ACTIONS, d3, HarvestSimulator, colors){\n    $scope.ngModelOptions = {\n      debounce: { 'default': 500, 'blur': 0 }\n    };\n\n    $scope.truck_types = {\n      apron: {\n        label: 'Apron Body',\n        capacity: 14,  // Mg\n        road: 48,  // kph\n        field: 20, // kph,\n        unload: 255 // second\n      },\n      dump: {\n        label: 'Dump Body',\n        capacity: 14,  // Mg\n        road: 47,  // kph\n        field: 20, // kph,\n        unload: 245 // second\n      },\n      semi: {\n        label: 'Semi Apron',\n        capacity: 23.5,\n        road: 52,\n        field: 16,\n        unload: 233\n      },\n      tractor : {\n        label: 'Hi-speed Tractor',\n        capacity: 17,  // Mg\n        road: 42,  // kph\n        field: 14.9, // kph,\n        unload: 386 // second\n      }\n    };\n\n    $scope.presetTruck = function (index) {\n      $scope.trucks[index] = angular.copy($scope.trucks[index].preset);\n    };\n\n    $scope.presetSimulations = {\n      7: {\n        field: {\n          tonnes: 660,\n          haul: 3.4, // one-way km\n          travel: 0.3, //  one-way avg km from road to chopper\n          sendPartials: false,\n          minPartial: 0.5,\n          holdTrucks: false\n        },\n        chopper: {\n          label: 'Harvester',\n          capacity: 204 // Mg/hr\n        },\n        trucks: [\n          {\n            label: 'Semi 4',\n            capacity: 23.1,\n            road: 52,\n            field: 16,\n            unload: 233\n          },\n          {\n            label: 'Semi 2',\n            capacity: 24.6,\n            road: 52,\n            field: 16,\n            unload: 233\n          },\n          {\n            label: 'Semi 5',\n            capacity: 23.1,\n            road: 52,\n            field: 16,\n            unload: 233\n          }\n        ]\n      },\n      34: {\n        field: {\n          tonnes: 372,\n          haul: 2.4, // one-way km\n          travel: 1, //  one-way avg km from road to chopper\n          sendPartials: false,\n          minPartial: 0.5,\n          holdTrucks: false\n        },\n        chopper: {\n          label: 'Harvester',\n          capacity: 182 // Mg/hr\n        },\n        trucks: [\n          {\n            label: 'Apron 12',\n            capacity: 13.1,\n            road: 48,\n            field: 20,\n            unload: 185\n          },\n          {\n            label: 'Dump 9',\n            capacity: 11.6,\n            road: 48,\n            field: 20,\n            unload: 185\n          },\n          {\n            label: 'Apron 7',\n            capacity: 13.6,\n            road: 48,\n            field: 20,\n            unload: 185\n          },\n          {\n            label: 'Apron 8',\n            capacity: 11.3,\n            road: 48,\n            field: 20,\n            unload: 185\n          },\n\n        ]\n      },\n      289: {\n        field: {\n          tonnes: 1027,\n          haul: 0.25, // one-way km\n          travel: 0.3, //  one-way avg km from road to chopper\n          sendPartials: false,\n          minPartial: 0.5,\n          holdTrucks: false\n        },\n        chopper: {\n          label: 'Harvester',\n          capacity: 224 // Mg/hr\n        },\n        trucks: [\n          {\n            label: 'Apron 144',\n            capacity: 14.5,\n            road: 48,\n            field: 20,\n            unload: 181\n          },\n          {\n            label: 'Apron 145',\n            capacity: 14.4,\n            road: 48,\n            field: 20,\n            unload: 181\n          },\n          {\n            label: 'Apron 146',\n            capacity: 14.4,\n            road: 48,\n            field: 20,\n            unload: 181\n          },\n        ]\n      }\n\n    };\n\n    $scope.selectPreset = function (data) {\n      $scope.trucks = data.trucks;\n      $scope.field = data.field;\n      $scope.chopper = data.chopper;\n    };\n\n    $scope.field = {\n      tonnes: 300,\n      haul: 4, // one-way km\n      travel: 0.5, //  one-way avg km from road to chopper\n      sendPartials: false,\n      minPartial: 0.5,\n      holdTrucks: false\n    };\n\n    $scope.removeTruck = function (index) {\n      $scope.trucks.splice(index, 1);\n    };\n\n    $scope.addTruck = function (type) {\n      $scope.trucks.push(angular.copy($scope.truck_types[type || 'apron']));\n    };\n\n    var truckCount = 3;\n    $scope.trucks = [];\n    for (var i = 0; i < truckCount; i ++){\n      $scope.addTruck('semi');\n    }\n    // $scope.addTruck('semi');\n    $scope.chopper = {\n      label: 'Harvester',\n      capacity: 200 // Mg/hr\n    };\n\n    $scope.getCurrentAction = function(time, log){\n      for (var i = log.length; i--;){\n        if ( log[i].time <= time ){\n          return log[i];\n        }\n      }\n    };\n\n    var formatter = function(value) {\n      this.style('fill', colors[value.action] || 'FFFF09')\n        .style('stroke', colors[value.action] || 'FFFF09');\n    };\n\n    $scope.chartMeta = {\n      rangeChoices: [\n        {label: '30 Minutes', value: 1800},\n        {label: '1 Hour', value: 3600},\n        {label: '2 Hours', value: 7200},\n        {label: '3 Hours', value: 10800},\n        {label: '4 Hours', value: 14400},\n        // {label: 'Full Harvest', value: undefined}\n      ],\n      start: 0,\n      duration: 3600,\n      data: [],\n      valuesName: 'actionLog',\n      formatter: formatter,\n      callback: function (chart) {\n        $scope.chart = chart;\n      },\n      tooltip: function(e){\n        var scope = $scope.$new();\n        scope.data = e;\n        // scope.point = e;\n        return $interpolate($templateCache.get('template/loadTooltip.html'))(scope);\n      },\n      margin: {left: 125}\n    };\n\n    $scope.meta = {\n      tonnes: 2500\n    };\n    \n    $scope.actionKey = [\n      {label: 'Loading', color: colors[ACTIONS.LOADING]},\n      {label: 'Waiting', color: colors[ACTIONS.WAIT]},\n      {label: 'Field Travel', color: colors[ACTIONS.FIELD_EMPTY]},\n      {label: 'Road Travel', color: colors[ACTIONS.ROAD_EMPTY]},\n      {label: 'Unload', color: colors[ACTIONS.UNLOAD]}\n    ];\n  });\n})();\n\nangular.module('trucksim')\n  .directive('json', function() {\n  return {\n    restrict: 'A', // only activate on element attribute\n    require: 'ngModel', // get a hold of NgModelController\n    link: function(scope, element, attrs, ngModelCtrl) {\n      function fromUser(text) {\n        // Beware: trim() is not available in old browsers\n        if (!text || text.trim() === '')\n          return {}\n        else\n          // TODO catch SyntaxError, and set validation error..\n          return angular.fromJson(text);\n      }\n\n      function toUser(object) {\n          // better than JSON.stringify(), because it formats + filters $$hashKey etc.\n          return angular.toJson(object, true);\n      }\n      \n      // push() if faster than unshift(), and avail. in IE8 and earlier (unshift isn't)\n      ngModelCtrl.$parsers.push(fromUser);\n      ngModelCtrl.$formatters.push(toUser);\n      \n      // $watch(attrs.ngModel) wouldn't work if this directive created a new scope;\n      // see http://stackoverflow.com/questions/14693052/watch-ngmodel-from-inside-directive-using-isolate-scope how to do it then\n      scope.$watch(attrs.ngModel, function(newValue, oldValue) {\n        if (newValue != oldValue) {\n          ngModelCtrl.$setViewValue(toUser(newValue));\n          // TODO avoid this causing the focus of the input to be lost..\n          ngModelCtrl.$render();\n        }\n      }, true); // MUST use objectEquality (true) here, for some reason..\n    }\n  };  \n});\n\nangular\n  .module('trucksim')\n  .filter('toMinutes', function () {\n    return function (seconds) {\n      var residual = seconds % 60,\n        minutes = (seconds - residual) / 60;\n      residual = ('0' + residual.toString()).slice(-2);\n      return minutes.toString() + ':' + residual;\n    };\n  })\n  .filter('secondsToDateTime', function() {\n    return function(seconds) {\n      return new Date(1970, 0, 1).setSeconds(seconds);\n      };\n  })\n  .filter('percent', function(){\n    return function (decimal, fractionSize) {\n      if ( angular.isUndefined(fractionSize) ){\n        fractionSize = 0;\n      }\n      return (decimal * 100).toFixed(fractionSize).toString() + '%';\n    };\n  });\n\n/** This file contains constants with observered data\n */\nangular\n  .module('trucksim')\n  .constant('field48', '{\"41\":[{\"action\":\"road1\",\"start\":996.0,\"duration\":862.0},{\"action\":\"wait\",\"start\":1858.0,\"duration\":55.0},{\"action\":\"field_travel1\",\"start\":1913.0,\"duration\":15.0},{\"action\":\"wait\",\"start\":1928.0,\"duration\":18.0},{\"action\":\"loading\",\"start\":1946.0,\"duration\":71.0},{\"action\":\"wait\",\"start\":2017.0,\"duration\":8.0},{\"action\":\"loading\",\"start\":2025.0,\"duration\":404.0},{\"action\":\"wait\",\"start\":2429.0,\"duration\":6.0},{\"action\":\"loading\",\"start\":2435.0,\"duration\":92.0},{\"action\":\"wait\",\"start\":2527.0,\"duration\":57.0},{\"action\":\"field_travel1\",\"start\":2584.0,\"duration\":52.0},{\"action\":\"wait\",\"start\":2636.0,\"duration\":52.0},{\"action\":\"field_travel1\",\"start\":2688.0,\"duration\":7.0},{\"action\":\"road1\",\"start\":2695.0,\"duration\":1024.0},{\"action\":\"taxi\",\"start\":3719.0,\"duration\":17.0},{\"action\":\"scale\",\"start\":3736.0,\"duration\":18.0},{\"action\":\"taxi\",\"start\":3754.0,\"duration\":56.0},{\"action\":\"unload\",\"start\":3810.0,\"duration\":6.0},{\"action\":\"taxi\",\"start\":3816.0,\"duration\":86.0},{\"action\":\"unload\",\"start\":3902.0,\"duration\":146.0},{\"action\":\"taxi\",\"start\":4048.0,\"duration\":146.0},{\"action\":\"unload\",\"start\":4194.0,\"duration\":52.0},{\"action\":\"taxi\",\"start\":4246.0,\"duration\":64.0},{\"action\":\"road1\",\"start\":4310.0,\"duration\":867.0},{\"action\":\"field_travel1\",\"start\":5177.0,\"duration\":66.0},{\"action\":\"loading\",\"start\":5243.0,\"duration\":580.0},{\"action\":\"wait\",\"start\":5823.0,\"duration\":16.0},{\"action\":\"field_travel1\",\"start\":5839.0,\"duration\":56.0},{\"action\":\"road1\",\"start\":5895.0,\"duration\":1057.0},{\"action\":\"taxi\",\"start\":6952.0,\"duration\":27.0},{\"action\":\"scale\",\"start\":6979.0,\"duration\":10.0},{\"action\":\"taxi\",\"start\":6989.0,\"duration\":54.0},{\"action\":\"unload\",\"start\":7043.0,\"duration\":48.0},{\"action\":\"taxi\",\"start\":7091.0,\"duration\":29.0},{\"action\":\"unload\",\"start\":7120.0,\"duration\":7.0},{\"action\":\"taxi\",\"start\":7127.0,\"duration\":6.0},{\"action\":\"unload\",\"start\":7133.0,\"duration\":183.0},{\"action\":\"taxi\",\"start\":7316.0,\"duration\":51.0},{\"action\":\"scale\",\"start\":7367.0,\"duration\":6.0},{\"action\":\"taxi\",\"start\":7373.0,\"duration\":10.0}],\"42\":[{\"action\":\"road1\",\"start\":364.0,\"duration\":830.0},{\"action\":\"field_travel1\",\"start\":1194.0,\"duration\":23.0},{\"action\":\"loading\",\"start\":1217.0,\"duration\":171.0},{\"action\":\"road1\",\"start\":1388.0,\"duration\":16.0},{\"action\":\"loading\",\"start\":1404.0,\"duration\":165.0},{\"action\":\"wait\",\"start\":1569.0,\"duration\":1.0},{\"action\":\"loading\",\"start\":1570.0,\"duration\":100.0},{\"action\":\"wait\",\"start\":1670.0,\"duration\":13.0},{\"action\":\"loading\",\"start\":1683.0,\"duration\":41.0},{\"action\":\"wait\",\"start\":1724.0,\"duration\":16.0},{\"action\":\"loading\",\"start\":1740.0,\"duration\":12.0},{\"action\":\"wait\",\"start\":1752.0,\"duration\":122.0},{\"action\":\"loading\",\"start\":1874.0,\"duration\":82.0},{\"action\":\"wait\",\"start\":1956.0,\"duration\":61.0},{\"action\":\"field_travel1\",\"start\":2017.0,\"duration\":53.0},{\"action\":\"road1\",\"start\":2070.0,\"duration\":1125.0},{\"action\":\"taxi\",\"start\":3195.0,\"duration\":10.0},{\"action\":\"scale\",\"start\":3205.0,\"duration\":90.0},{\"action\":\"taxi\",\"start\":3295.0,\"duration\":64.0},{\"action\":\"unload\",\"start\":3359.0,\"duration\":19.0},{\"action\":\"taxi\",\"start\":3378.0,\"duration\":15.0},{\"action\":\"unload\",\"start\":3393.0,\"duration\":147.0},{\"action\":\"taxi\",\"start\":3540.0,\"duration\":61.0},{\"action\":\"road1\",\"start\":3601.0,\"duration\":893.0},{\"action\":\"field_travel1\",\"start\":4494.0,\"duration\":57.0},{\"action\":\"loading\",\"start\":4551.0,\"duration\":363.0},{\"action\":\"wait\",\"start\":4914.0,\"duration\":9.0},{\"action\":\"loading\",\"start\":4923.0,\"duration\":270.0},{\"action\":\"field_travel1\",\"start\":5193.0,\"duration\":82.0},{\"action\":\"road1\",\"start\":5275.0,\"duration\":1361.0},{\"action\":\"taxi\",\"start\":6636.0,\"duration\":20.0},{\"action\":\"scale\",\"start\":6656.0,\"duration\":20.0},{\"action\":\"taxi\",\"start\":6676.0,\"duration\":59.0},{\"action\":\"unload\",\"start\":6735.0,\"duration\":6.0},{\"action\":\"taxi\",\"start\":6741.0,\"duration\":23.0},{\"action\":\"unload\",\"start\":6764.0,\"duration\":13.0},{\"action\":\"taxi\",\"start\":6777.0,\"duration\":7.0},{\"action\":\"unload\",\"start\":6784.0,\"duration\":195.0},{\"action\":\"taxi\",\"start\":6979.0,\"duration\":71.0},{\"action\":\"scale\",\"start\":7050.0,\"duration\":5.0},{\"action\":\"taxi\",\"start\":7055.0,\"duration\":10.0}],\"43\":[{\"action\":\"loading\",\"start\":294.0,\"duration\":534.0},{\"action\":\"wait\",\"start\":828.0,\"duration\":7.0},{\"action\":\"loading\",\"start\":835.0,\"duration\":17.0},{\"action\":\"wait\",\"start\":852.0,\"duration\":12.0},{\"action\":\"loading\",\"start\":864.0,\"duration\":16.0},{\"action\":\"wait\",\"start\":880.0,\"duration\":23.0},{\"action\":\"loading\",\"start\":903.0,\"duration\":92.0},{\"action\":\"field_travel1\",\"start\":995.0,\"duration\":159.0},{\"action\":\"loading\",\"start\":1154.0,\"duration\":23.0},{\"action\":\"wait\",\"start\":1177.0,\"duration\":12.0},{\"action\":\"field_travel1\",\"start\":1189.0,\"duration\":2.0},{\"action\":\"road1\",\"start\":1191.0,\"duration\":1385.0},{\"action\":\"taxi\",\"start\":2576.0,\"duration\":22.0},{\"action\":\"scale\",\"start\":2598.0,\"duration\":41.0},{\"action\":\"taxi\",\"start\":2639.0,\"duration\":88.0},{\"action\":\"unload\",\"start\":2727.0,\"duration\":8.0},{\"action\":\"taxi\",\"start\":2735.0,\"duration\":9.0},{\"action\":\"unload\",\"start\":2744.0,\"duration\":140.0},{\"action\":\"taxi\",\"start\":2884.0,\"duration\":58.0},{\"action\":\"road1\",\"start\":2942.0,\"duration\":958.0},{\"action\":\"field_travel1\",\"start\":3900.0,\"duration\":40.0},{\"action\":\"loading\",\"start\":3940.0,\"duration\":574.0},{\"action\":\"field_travel1\",\"start\":4514.0,\"duration\":25.0},{\"action\":\"loading\",\"start\":4539.0,\"duration\":12.0},{\"action\":\"wait\",\"start\":4551.0,\"duration\":17.0},{\"action\":\"field_travel1\",\"start\":4568.0,\"duration\":56.0},{\"action\":\"road1\",\"start\":4624.0,\"duration\":1329.0},{\"action\":\"taxi\",\"start\":5953.0,\"duration\":6.0},{\"action\":\"scale\",\"start\":5959.0,\"duration\":6.0},{\"action\":\"taxi\",\"start\":5965.0,\"duration\":22.0},{\"action\":\"scale\",\"start\":5987.0,\"duration\":19.0},{\"action\":\"taxi\",\"start\":6006.0,\"duration\":74.0},{\"action\":\"unload\",\"start\":6080.0,\"duration\":6.0},{\"action\":\"taxi\",\"start\":6086.0,\"duration\":9.0},{\"action\":\"unload\",\"start\":6095.0,\"duration\":179.0},{\"action\":\"taxi\",\"start\":6274.0,\"duration\":51.0}],\"harvester\":[{\"action\":\"wait\",\"start\":0.0,\"duration\":16.0},{\"action\":\"loading\",\"start\":16.0,\"duration\":6.0},{\"action\":\"idle\",\"start\":22.0,\"duration\":45.0},{\"action\":\"loading\",\"start\":67.0,\"duration\":9.0},{\"action\":\"idle\",\"start\":76.0,\"duration\":213.0},{\"action\":\"loading\",\"start\":289.0,\"duration\":540.0},{\"action\":\"idle\",\"start\":829.0,\"duration\":6.0},{\"action\":\"loading\",\"start\":835.0,\"duration\":45.0},{\"action\":\"idle\",\"start\":880.0,\"duration\":7.0},{\"action\":\"loading\",\"start\":887.0,\"duration\":155.0},{\"action\":\"wait\",\"start\":1042.0,\"duration\":112.0},{\"action\":\"loading\",\"start\":1154.0,\"duration\":238.0},{\"action\":\"wait\",\"start\":1392.0,\"duration\":5.0},{\"action\":\"loading\",\"start\":1397.0,\"duration\":283.0},{\"action\":\"idle\",\"start\":1680.0,\"duration\":2.0},{\"action\":\"loading\",\"start\":1682.0,\"duration\":42.0},{\"action\":\"idle\",\"start\":1724.0,\"duration\":16.0},{\"action\":\"loading\",\"start\":1740.0,\"duration\":12.0},{\"action\":\"idle\",\"start\":1752.0,\"duration\":87.0},{\"action\":\"loading\",\"start\":1839.0,\"duration\":29.0},{\"action\":\"idle\",\"start\":1868.0,\"duration\":6.0},{\"action\":\"loading\",\"start\":1874.0,\"duration\":150.0},{\"action\":\"idle\",\"start\":2024.0,\"duration\":3.0},{\"action\":\"loading\",\"start\":2027.0,\"duration\":428.0},{\"action\":\"unknown\",\"start\":2455.0,\"duration\":1.0},{\"action\":\"loading\",\"start\":2456.0,\"duration\":231.0},{\"action\":\"idle\",\"start\":2687.0,\"duration\":1.0},{\"action\":\"loading\",\"start\":2688.0,\"duration\":358.0},{\"action\":\"wait\",\"start\":3046.0,\"duration\":12.0},{\"action\":\"loading\",\"start\":3058.0,\"duration\":29.0},{\"action\":\"wait\",\"start\":3087.0,\"duration\":853.0},{\"action\":\"loading\",\"start\":3940.0,\"duration\":574.0},{\"action\":\"wait\",\"start\":4514.0,\"duration\":25.0},{\"action\":\"loading\",\"start\":4539.0,\"duration\":654.0},{\"action\":\"wait\",\"start\":5193.0,\"duration\":50.0},{\"action\":\"loading\",\"start\":5243.0,\"duration\":943.0},{\"action\":\"idle\",\"start\":6186.0,\"duration\":13.0},{\"action\":\"loading\",\"start\":6199.0,\"duration\":51.0},{\"action\":\"wait\",\"start\":6250.0,\"duration\":1.0},{\"action\":\"idle\",\"start\":6251.0,\"duration\":196.0},{\"action\":\"loading\",\"start\":6447.0,\"duration\":126.0},{\"action\":\"idle\",\"start\":6573.0,\"duration\":30.0},{\"action\":\"loading\",\"start\":6603.0,\"duration\":62.0},{\"action\":\"wait\",\"start\":6665.0,\"duration\":21.0},{\"action\":\"loading\",\"start\":6686.0,\"duration\":24.0},{\"action\":\"idle\",\"start\":6710.0,\"duration\":56.0},{\"action\":\"loading\",\"start\":6766.0,\"duration\":15.0},{\"action\":\"idle\",\"start\":6781.0,\"duration\":17.0},{\"action\":\"loading\",\"start\":6798.0,\"duration\":19.0},{\"action\":\"idle\",\"start\":6817.0,\"duration\":821.0},{\"action\":\"loading\",\"start\":7638.0,\"duration\":17.0},{\"action\":\"unknown\",\"start\":7655.0,\"duration\":0.0}],\"39\":[{\"action\":\"road1\",\"start\":1012.0,\"duration\":940.0},{\"action\":\"field_travel1\",\"start\":1952.0,\"duration\":50.0},{\"action\":\"wait\",\"start\":2002.0,\"duration\":218.0},{\"action\":\"field_travel1\",\"start\":2220.0,\"duration\":49.0},{\"action\":\"wait\",\"start\":2269.0,\"duration\":4.0},{\"action\":\"field_travel1\",\"start\":2273.0,\"duration\":8.0},{\"action\":\"wait\",\"start\":2281.0,\"duration\":12.0},{\"action\":\"field_travel1\",\"start\":2293.0,\"duration\":8.0},{\"action\":\"wait\",\"start\":2301.0,\"duration\":96.0},{\"action\":\"field_travel1\",\"start\":2397.0,\"duration\":3.0},{\"action\":\"wait\",\"start\":2400.0,\"duration\":121.0},{\"action\":\"loading\",\"start\":2521.0,\"duration\":1.0},{\"action\":\"wait\",\"start\":2522.0,\"duration\":1.0},{\"action\":\"loading\",\"start\":2523.0,\"duration\":410.0},{\"action\":\"wait\",\"start\":2933.0,\"duration\":3.0},{\"action\":\"loading\",\"start\":2936.0,\"duration\":110.0},{\"action\":\"field_travel1\",\"start\":3046.0,\"duration\":12.0},{\"action\":\"loading\",\"start\":3058.0,\"duration\":29.0},{\"action\":\"field_travel1\",\"start\":3087.0,\"duration\":23.0},{\"action\":\"road1\",\"start\":3110.0,\"duration\":1253.0},{\"action\":\"taxi\",\"start\":4363.0,\"duration\":17.0},{\"action\":\"scale\",\"start\":4380.0,\"duration\":8.0},{\"action\":\"taxi\",\"start\":4388.0,\"duration\":59.0},{\"action\":\"unload\",\"start\":4447.0,\"duration\":43.0},{\"action\":\"taxi\",\"start\":4490.0,\"duration\":37.0},{\"action\":\"unload\",\"start\":4527.0,\"duration\":149.0},{\"action\":\"taxi\",\"start\":4676.0,\"duration\":44.0},{\"action\":\"road1\",\"start\":4720.0,\"duration\":971.0},{\"action\":\"field_travel1\",\"start\":5691.0,\"duration\":77.0},{\"action\":\"wait\",\"start\":5768.0,\"duration\":55.0},{\"action\":\"loading\",\"start\":5823.0,\"duration\":267.0},{\"action\":\"wait\",\"start\":6090.0,\"duration\":13.0},{\"action\":\"loading\",\"start\":6103.0,\"duration\":80.0},{\"action\":\"wait\",\"start\":6183.0,\"duration\":16.0},{\"action\":\"loading\",\"start\":6199.0,\"duration\":51.0},{\"action\":\"field_travel1\",\"start\":6250.0,\"duration\":1.0},{\"action\":\"wait\",\"start\":6251.0,\"duration\":197.0},{\"action\":\"loading\",\"start\":6448.0,\"duration\":124.0},{\"action\":\"wait\",\"start\":6572.0,\"duration\":34.0},{\"action\":\"loading\",\"start\":6606.0,\"duration\":59.0},{\"action\":\"field_travel1\",\"start\":6665.0,\"duration\":21.0},{\"action\":\"loading\",\"start\":6686.0,\"duration\":5.0},{\"action\":\"field_travel1\",\"start\":6691.0,\"duration\":4.0},{\"action\":\"loading\",\"start\":6695.0,\"duration\":2.0},{\"action\":\"wait\",\"start\":6697.0,\"duration\":941.0},{\"action\":\"loading\",\"start\":7638.0,\"duration\":12.0},{\"action\":\"wait\",\"start\":7650.0,\"duration\":1.0},{\"action\":\"loading\",\"start\":7651.0,\"duration\":30.0},{\"action\":\"road1\",\"start\":7681.0,\"duration\":1483.0},{\"action\":\"taxi\",\"start\":9164.0,\"duration\":15.0},{\"action\":\"scale\",\"start\":9179.0,\"duration\":33.0},{\"action\":\"taxi\",\"start\":9212.0,\"duration\":76.0},{\"action\":\"unload\",\"start\":9288.0,\"duration\":133.0},{\"action\":\"taxi\",\"start\":9421.0,\"duration\":70.0},{\"action\":\"scale\",\"start\":9491.0,\"duration\":9.0},{\"action\":\"taxi\",\"start\":9500.0,\"duration\":13.0}]}')\n\nangular\n  .module('trucksim')\n  /**\n   * @ngdoc directive\n   * @name timeChart\n   * @param {Object} An object which describe the chart.\n   *  `data`: required Array of Objects. Each object in the array will be a series. And must have a `label` property and a `values` array\n   *      within the values array each object must have a `start` and a `duration`.\n   *  `margin`: optional\n   *  `valuesName` property of data holding values. Default 'values'\n   *  `formatter`: function `this` will be the d3 element, the only argument will be the value. Use it to apply colors, etc.\n   *  `callback: callback which will be executed when the directive is registered.\n   *  `startTime` Date or unix timestamp when the chart should start\n   *  `duration` duration of the chart in seconds\n   *  `timeFormat` d3 time format for the x axis\n   *  it will receive the directive scope as the only argument.\n   * @description A directive which builds an svg with a time axis on the bottom\n   * and an ordinal axis on the left. It exposes an api to draw bars for time periods\n   * using the axis intersection as the origin.\n   *\n   */\n  .directive('timeChart', function ($timeout, d3, $compile) {\n    var tooltip;\n\n    return {\n      restrict: 'EA',\n      scope: {\n        options: '='\n      },\n      controller: function ($scope) {\n        var formatTime = d3.time.format(\"%H:%M\"),\n          formatMinutes = function(d) { return formatTime(new Date(2000, 1, 1, 0, 0, d)); };\n\n        var dataGroups = [];\n\n        $scope.drawAxes = function drawAxes(scales) {\n          var xAxis = d3.svg.axis().scale(scales.x).orient('bottom').tickFormat(formatMinutes);\n\t        var yAxis = d3.svg.axis().scale(scales.y).orient('left').tickFormat(function (d) {\n            return $scope.options.data[d].label;\n          });\n          var dims = $scope.dimensions;\n\n          $scope.canvas = $scope.svg\n            .attr('height', dims.height)\n            .attr('width', dims.width)\n            .append('g')\n            .attr(\"transform\", \"translate(\" + dims.margin.left + \",\" + dims.margin.top + \")\");\n\n          $scope.svg.append('g')\n            .attr(\"transform\", \"translate(\" + dims.margin.left + \",\" + (dims.height - dims.margin.top - dims.margin.bottom) + \")\")\n            .attr('fill', 'none')\n            .attr('stroke', '#000')\n            .attr('shape-rendering', 'crispEdges')\n            .call(xAxis);\n\n          $scope.svg.append('g')\n            .attr(\"transform\", \"translate(\" + dims.margin.left + \",\" + -dims.margin.top + \")\")\n            .attr('fill', 'none')\n            .attr('stroke', '#000')\n            .attr('shape-rendering', 'crispEdges')\n            .call(yAxis);\n\n          dataGroups = [];\n          $scope.options.data.forEach(function (row, index) {\n            dataGroups[index] = $scope.canvas.append('g')\n              .attr('transform', 'translate(0,' + (scales.y(index) - dims.fullRowHeight/2 - dims.gutter) +')');\n          });\n        };\n\n        /**\n         *\n         * @param index: ordinal index for the y axis\n         * @param value: object which must contain `start` and `duration`\n         * @description:\n         */\n        var dragStartAction, mouseIsDown;\n        $scope.drawValue = function (index, value, series) {\n          var x, width,\n            xmin = $scope.dimensions.scales.x.domain()[0];\n          if ( value.start + value.duration < xmin || value.start > $scope.dimensions.scales.x.domain()[1] ){ return; }\n          else if (value.start < xmin ){\n            x = xmin;\n            width = value.duration - (xmin- value.start);\n          }\n          else {\n            x = value.start;\n            width = value.duration;\n          }\n          var rect = dataGroups[index].append('rect')\n            .attr('x', $scope.dimensions.scales.x(x))\n            .attr('width', $scope.dimensions.scales.x(width + $scope.options.start))\n            .attr('height', $scope.dimensions.barHeight)\n            .style('stoke-opacity', 1)\n            .style('fill-opacity', 0.75)\n              .on(\"mouseover\", function(d){\n                if ( angular.isDefined(dragStartAction) ){\n                  if ( value !== dragStartAction){\n                    $scope.hideTooltip();\n                  }\n                  return;\n                }\n                var tipScope = $scope.$new();\n                tipScope.data = value;\n                tipScope.actionLog = series.actionLog;\n                tooltip.html($scope.options.tooltip.call(this, value, tipScope));\n                $timeout(function () {\n                  $compile(angular.element(tooltip[0][0]).contents())(tipScope);\n                });\n                tooltip.transition().duration(200).style(\"opacity\", 0.9);\n                tooltip.style(\"top\", (event.pageY-10)+\"px\").style(\"left\",(event.pageX+10)+\"px\");\n              })\n              .on(\"click\", function(){\n                return tooltip.style(\"top\", (event.pageY)+\"px\").style(\"left\",(event.pageX)+\"px\");\n              })\n              .on('mousedown', function (e) {\n                dragStartAction = value;\n              })\n              .on('mouseup', function (e) {\n                if ( angular.isDefined($scope.options.dragFn) ){\n                  $scope.options.dragFn.call(series.actionLog, dragStartAction, value);\n                }\n                dragStartAction = undefined;\n              })\n              .on(\"mouseout\", function(){return tooltip.transition().duration(200).style(\"opacity\", 0); });\n\n          if ( angular.isDefined($scope.options.formatter) ){\n            $scope.options.formatter.call(rect, value);\n          }\n        };\n\n        $scope.drawData = function () {\n          $scope.options.data.forEach(function (series, index) {\n            series[$scope.options.valuesName || 'values'].forEach(function (value) {\n              $scope.drawValue(index, value, series);\n            });\n          });\n        };\n\n        /**\n         * @ngdoc\n         * @description introspects the data to determine dimensions\n         */\n        $scope.getScales = function () {\n          var scales = {};\n          var dims = $scope.dimensions;\n          var data = $scope.options.data || [];\n          var yDomain = [],\n            yRange = [];\n\n          dims.fullRowHeight = dims.innerHeight / (data.length || 1);\n          dims.gutter = dims.fullRowHeight * 0.1;\n          dims.barHeight = dims.fullRowHeight - dims.gutter;\n\n          for ( var i=0; i < $scope.options.data.length; i++){\n            yDomain.push(i);\n            yRange.push(i*dims.fullRowHeight + dims.barHeight/2);\n          }\n\n          scales.y = d3.scale.ordinal().domain(yDomain).range(yRange.reverse());\n          scales.x = d3.time.scale.utc().domain([$scope.options.start || 0, (parseInt($scope.options.start) || 0) + (parseInt($scope.options.duration) || 3600)])\n            .range([0, dims.width - dims.margin.left - dims.margin.right]);\n          dims.scales = scales;\n          return scales;\n        };\n\n        $scope.hideTooltip = function(){return tooltip.transition().duration(200).style(\"opacity\", 0); };\n      },\n      link: function (scope, element, attrs) {\n        scope.dimensions = {};\n        scope.dimensions.margin = angular.extend({top: 10, right: 30, bottom: 30, left: 75},scope.options.margin);\n        var el = element[0];\n\n        scope.resize = function () {\n          var dims = scope.dimensions;\n          dims.height = el.offsetHeight;\n          dims.width = el.offsetWidth;\n          dims.innerHeight = dims.height - dims.margin.top - dims.margin.bottom;\n          dims.innerWidth = dims.width - dims.margin.left - dims.margin.right;\n        };\n        scope.resize();\n\n        scope.svg = d3.select(el).append('svg');\n        d3.select('body>.tooltip').remove();\n        tooltip = d3.select('body')\n          .append('div')\n          .attr('class', 'tooltip')\n          .style('background', '#FFF')\n          .style('border-radius', '4px')\n          .style('padding-left', '10px')\n          .style('opacity', 0);\n\n        scope.refresh = function () {\n          scope.svg.selectAll('*').remove();\n          scope.resize();\n          scope.drawAxes(scope.getScales());\n          scope.drawData();\n        };\n\n        scope.refresh();\n\n        if ( angular.isDefined(scope.options.callback) ){\n          scope.options.callback.call(scope.svg, scope);\n        }\n      }\n    };\n  });\n\nangular.module('trucksim')\n  .directive('jsonClipboard', function($log) {\n    return {\n      restrict: 'A',\n      link: function (scope, element, attr) {\n\n        var clipboard = new Clipboard(element[0], {\n          text: function (trigger) {\n            scope.observe.copyData = {};\n            scope.chartMeta.data.forEach(function (series) {\n              scope.observe.copyData[series.machine] = series.actionLog;\n            });\n            return angular.toJson(scope.observe.copyData, true);\n          }\n        });\n\n        clipboard.on('success', function(e) {\n            $log.debug(e);\n        });\n\n        clipboard.on('error', function(e) {\n            $log.debug(e);\n        });\n      }\n    };\n  });\n\nangular\n  .module('trucksim')\n  .factory('defaultChartOptions', function (d3, $templateCache, $rootScope, $interpolate) {\n    var hourFormat = d3.time.format('%H:%M:%S');\n    function intToTime(d){\n      var time = new Date(1970, 0, 1);\n      time.setSeconds(d);\n      return hourFormat(time);\n    }\n\n    return {\n      chart: {\n        type: 'multiBarHorizontalChart',\n        noData: 'Loading chart...',\n        height: 450,\n        showLegend: false,\n        showControls: false,\n        tooltip: {\n          contentGenerator: function(e){\n            var scope = $rootScope.$new();\n            scope.data = e.data;\n            scope.point = e;\n            return $interpolate($templateCache.get('template/loadTooltip.html'))(scope);\n          }\n        },\n        margin : {\n          top: 20,\n          right: 20,\n          bottom: 45,\n          left: 45\n        },\n        clipEdge: true,\n        duration: 10,\n        stacked: true,\n        xAxis: {\n          axisLabel: 'Machine',\n          showMaxMin: false,\n          tickFormat: function(d){\n            if ( d === 0){ return 'Harvester'; }\n            else { return 'Truck ' + d.toString(); }\n          }\n        },\n        yAxis: {\n          axisLabel: 'Time',\n          axisLabelDistance: 0,\n          scale: 3600*6,\n          ticks:6,\n          tickFormat: intToTime\n        }\n      }\n    };\n  })\n  .factory('buildRectangle', function () {\n    return function buildRect(opts){\n      return [\n        opts,\n        {x: opts.x + opts.w, y: opts.y},\n        {x: opts.x + opts.w, y: opts.y + opts.h},\n        {x: opts.x, y: opts.y + opts.h},\n      ];\n    };\n  });\n\n/* global malarkey:false, moment:false, d3:false */\n(function() {\n  'use strict';\n\n  angular\n    .module('trucksim')\n    .constant('malarkey', malarkey)\n    .constant('moment', moment)\n    .constant('d3', d3)\n})();\n"],"sourceRoot":"/source/"}